"use strict";(self.webpackChunk_1000goals_frontend=self.webpackChunk_1000goals_frontend||[]).push([[836],{9836:(x,v,c)=>{c.d(v,{e:()=>J});var d=c(4755),e=c(1902),f=c(1354),r=c(1591);const G=["buttoncontainer"],C=["reachedgoal"],y=["upvote"];function P(o,s){1&o&&(e.TgZ(0,"div"),e._uU(1," 2 points "),e.qZA())}const h=function(o){return{"reached-badge":o}};function T(o,s){if(1&o&&(e.TgZ(0,"div",12),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.Q6J("ngClass",e.VKq(2,h,t.reached)),e.xp6(1),e.hij(" ",t.goal.points||2," ")}}function u(o,s){if(1&o&&(e.TgZ(0,"div",13),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.Q6J("ngClass",e.VKq(2,h,t.reached)),e.xp6(1),e.hij(" ",t.upvoteRatio," ")}}function g(o,s){1&o&&(e.TgZ(0,"span",18),e._uU(1," I reached this goal "),e.qZA())}function p(o,s){1&o&&(e.TgZ(0,"span",18),e._uU(1," I did not reach this goal! "),e.qZA())}function l(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",15)(1,"app-button",16),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onClickGoal())}),e.YNc(2,g,2,0,"span",17),e.YNc(3,p,2,0,"span",17),e.qZA()()}if(2&o){const t=e.oxw(2);e.Q6J("@showAction",t.show),e.xp6(2),e.Q6J("ngIf",!t.reached),e.xp6(1),e.Q6J("ngIf",t.reached)}}function b(o,s){if(1&o&&e.YNc(0,l,4,3,"div",14),2&o){const t=e.oxw();e.Q6J("ngIf",t.withAction&&t.show)}}function U(o,s){1&o&&(e.TgZ(0,"span",18),e._uU(1,"Remove your vote"),e.qZA())}function w(o,s){1&o&&(e.TgZ(0,"span",18),e._uU(1," Upvote this goal "),e.qZA())}function O(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",15)(1,"app-button",16),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onClickGoal())}),e.YNc(2,U,2,0,"span",17),e.YNc(3,w,2,0,"span",17),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.upvoted),e.xp6(1),e.Q6J("ngIf",!t.upvoted)}}function R(o,s){if(1&o&&e.YNc(0,O,4,2,"div",14),2&o){const t=e.oxw();e.Q6J("ngIf",t.withAction&&!t.isMyProposed&&t.show)}}const M=function(o,s){return{reached:o,myproposed:s}};let A=(()=>{class o{constructor(){this.withAction=!0,this.showPoints=!0,this.actionType="reached",this.reached=!1,this.upvoted=!1,this.isMyProposed=!1,this.upvoteRatio="0/0",this.clickOnGoal=new e.vpe,this.show=!1}toggleShowDetails(){!this.reached&&!this.showPoints||(this.show=!this.show)}onClickGoal(){this.clickOnGoal.emit(this.goal.id)}ngOnInit(){if(this.container){if("upvote"===this.actionType)return this.container.clear(),void this.container.createEmbeddedView(this.upvoteBtnTemplate);"reached"==this.actionType&&(this.container.clear(),this.container.createEmbeddedView(this.reachedGoalBtnTemplate))}}get isUpvote(){return"upvote"===this.actionType}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-goal-card"]],viewQuery:function(t,n){if(1&t&&(e.Gf(G,7,e.s_b),e.Gf(C,7,e.Rgc),e.Gf(y,7,e.Rgc)),2&t){let a;e.iGM(a=e.CRH())&&(n.container=a.first),e.iGM(a=e.CRH())&&(n.reachedGoalBtnTemplate=a.first),e.iGM(a=e.CRH())&&(n.upvoteBtnTemplate=a.first)}},inputs:{withAction:"withAction",showPoints:"showPoints",goal:"goal",actionType:"actionType",reached:"reached",upvoted:"upvoted",isMyProposed:"isMyProposed",upvoteRatio:"upvoteRatio"},outputs:{clickOnGoal:"clickOnGoal"},standalone:!0,features:[e.jDz],decls:17,vars:9,consts:[[1,"goal-card",3,"ngClass","click"],[1,"description-area"],[1,"description"],[4,"ngIf"],[1,"points-area"],["class","points-badge-modern",3,"ngClass",4,"ngIf"],["class","upvotes-badge",3,"ngClass",4,"ngIf"],[1,"title-area"],[1,"title"],["buttoncontainer",""],["reachedgoal",""],["upvote",""],[1,"points-badge-modern",3,"ngClass"],[1,"upvotes-badge",3,"ngClass"],["class","action-section",4,"ngIf"],[1,"action-section"],[3,"click"],["class","button-content",4,"ngIf"],[1,"button-content"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return n.toggleShowDetails()}),e.TgZ(1,"div",1)(2,"p",2),e._uU(3),e.qZA(),e.YNc(4,P,2,0,"div",3),e.qZA(),e.TgZ(5,"div",4),e.YNc(6,T,2,4,"div",5),e.YNc(7,u,2,4,"div",6),e.qZA(),e.TgZ(8,"div",7)(9,"span",8),e._uU(10),e.qZA()(),e.GkF(11,null,9),e.qZA(),e.YNc(13,b,1,1,"ng-template",null,10,e.W1O),e.YNc(15,R,1,1,"ng-template",null,11,e.W1O)),2&t&&(e.Q6J("ngClass",e.WLB(6,M,n.reached,n.isMyProposed)),e.xp6(3),e.hij(" ",n.goal.description||n.goal.name," "),e.xp6(1),e.Q6J("ngIf",n.isUpvote),e.xp6(2),e.Q6J("ngIf",n.showPoints&&!n.isUpvote),e.xp6(1),e.Q6J("ngIf",n.isUpvote),e.xp6(3),e.hij(" ",n.goal.name," "))},dependencies:[d.ez,d.mk,d.O5,f.r],styles:['.goal-card[_ngcontent-%COMP%]{outline:1px solid var(--border-primary-color);display:grid;grid-template-columns:1fr 7rem;grid-template-areas:"description points" "title title";grid-template-rows:1fr 1fr;padding:1rem 1.5rem;position:relative;overflow:hidden;background:rgba(255,255,255,0);box-shadow:0 4px 30px #0000001a;backdrop-filter:blur(6.9px);-webkit-backdrop-filter:blur(6.9px);box-shadow:inset 0 0 15px 1px #cacacac7;border:1px solid rgba(202,202,202,.24);border-radius:var(--border-radius);border:var(--border-primary)}.goal-card[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{text-transform:capitalize}.goal-card[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{z-index:1}.description-area[_ngcontent-%COMP%]{grid-area:description}.points-area[_ngcontent-%COMP%]{position:relative;grid-area:points}.title-area[_ngcontent-%COMP%]{display:flex;align-items:center;grid-area:title;font-size:2rem}.description[_ngcontent-%COMP%]{font-size:1rem}.points-badge[_ngcontent-%COMP%]{position:absolute;width:100%;height:4rem;top:-1.2rem;background-color:var(--goal-card-badge-bg);clip-path:polygon(0 0,100% 0,100% 100%,50% 87%,0 100%);border-radius:.3rem .3rem 0 0;display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:2rem}.points-badge.reached-badge[_ngcontent-%COMP%]{background-color:var(--success-primary);color:#000}.points-badge-modern[_ngcontent-%COMP%]{position:absolute;width:80%;height:2rem;top:.1rem;background-color:transparent;border:1px solid white;border-radius:var(--border-radius);right:0;text-align:center;display:flex;justify-content:center;align-items:center;font-size:15px}.points-badge-modern.reached-badge[_ngcontent-%COMP%]{background-color:var(--success-primary);color:#fff;font-weight:700}.upvotes-badge[_ngcontent-%COMP%]{background-color:var(--goal-card-badge-bg);clip-path:polygon(50% 0%,72% 23%,98% 35%,84% 64%,79% 91%,52% 84%,21% 91%,16% 61%,2% 35%,29% 22%);width:5.5rem;height:5.5rem;position:absolute;display:flex;justify-content:center;align-items:center;font-weight:700;left:2rem;top:-.5rem;font-size:1.5rem}.action-section[_ngcontent-%COMP%]{display:flex;font-size:2rem;gap:2rem;justify-content:center}.button-content[_ngcontent-%COMP%]{padding:.5rem;font-size:1.5rem}.reached[_ngcontent-%COMP%]{border-color:var(--success-primary)}.myproposed[_ngcontent-%COMP%]{border:1px solid #9595ea}'],data:{animation:[(0,r.X$)("showAction",[(0,r.eR)(":enter",[(0,r.oB)({maxHeight:"0px"}),(0,r.jt)(200,(0,r.oB)({maxHeight:"200px"}))]),(0,r.eR)(":leave",[(0,r.oB)({maxHeight:"200px"}),(0,r.jt)(200,(0,r.oB)({maxHeight:"0px"}))])])]}}),o})(),Z=(()=>{class o{transform(t,n=[]){return!!t&&n.includes(t)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"isReached",type:o,pure:!0,standalone:!0}),o})(),L=(()=>{class o{transform(t,n,a){return!(!n||!a)&&n?.find(m=>m.id===t.id)?.proposedBy===a}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"isMyProposed",type:o,pure:!0,standalone:!0}),o})(),S=(()=>{class o{transform(t,n,a){if(!n||!a)return"0/0";const i=n.find(m=>m.id===t.id);return i?`${i.votedBy.length}/${a}`:"0/0"}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"upvoteRatio",type:o,pure:!0,standalone:!0}),o})(),E=(()=>{class o{transform(t,n,a){if(!n||!a)return!1;const i=n.find(m=>m.id===t.id);return!!i&&i.votedBy.includes(a)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"upvotedPipe",type:o,pure:!0,standalone:!0}),o})();var D=c(3071),I=c(1397);function k(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"app-goal-card",4),e.NdJ("clickOnGoal",function(a){e.CHM(t);const i=e.oxw(2);return e.KtG(i.clickedOnGoal(a))}),e.ALo(1,"isReached"),e.ALo(2,"isMyProposed"),e.ALo(3,"upvotedPipe"),e.ALo(4,"upvoteRatio"),e.qZA()}if(2&o){const t=s.$implicit,n=e.oxw(2);e.Q6J("goal",t)("reached",e.xi3(1,7,null==t?null:t.id,n.userReachedGoals))("withAction",n.withAction)("isMyProposed",e.Dn7(2,10,t,n.proposedGoals,n.username))("upvoted",e.Dn7(3,14,t,n.proposedGoals,n.username))("actionType",n.actionType)("upvoteRatio",e.Dn7(4,18,t,n.proposedGoals,n.numberOfPlayers))}}function Y(o,s){if(1&o&&(e.TgZ(0,"div",2),e.YNc(1,k,5,22,"app-goal-card",3),e.qZA()),2&o){const t=e.oxw();e.Q6J("@listAnimation",t.list.length),e.xp6(1),e.Q6J("ngForOf",t.list)}}function B(o,s){1&o&&(e.TgZ(0,"p"),e._uU(1,"Nothing to show"),e.qZA())}let J=(()=>{class o{constructor(t,n){this.userService=t,this.gameService=n,this.list=[],this.userReachedGoals=[],this.withAction=!0,this.actionType="reached"}clickedReachedGoal(t){if(t){if(function N(o=[],s){return o.includes(s)}(this.userReachedGoals,t))return void this.userService.removeReachedGoal(t).subscribe(n=>{n?.data?.deleted&&this.userService.patchUserData(i=>{const _=i.user.goals.filter(m=>m!==t);return i.user.goals=_,i})});this.userService.insertReachedGoal(t).subscribe(n=>{n&&this.userService.patchUserData(a=>{const i=a.game?.players.find(_=>_?.name===a?.user?.name);return i&&(a.user.goals.push(t),i.goals.push(t)),a})})}}clickedOnUpvotedGoal(t){t&&this.gameService.upvoteProposedGoal(t)?.subscribe(n=>{const a=n.data;this.userService.patchUserData(i=>(!i.game?.proposedGoals||!i.game?.goals||!a?.goals||!a?.proposedGoals||(i.game.proposedGoals=a.proposedGoals,i.game.goals=a.goals),i))})}clickedOnGoal(t){"reached"===this.actionType?this.clickedReachedGoal(t):this.clickedOnUpvotedGoal(t)}get proposedGoals(){return this.userService.getUserData()?.game?.proposedGoals}get username(){return this.userService.getUserData()?.user?.name}get numberOfPlayers(){return this.userService.getUserData()?.game?.players?.length||0}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(D.K),e.Y36(I.h))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-goal-list"]],inputs:{list:"list",userReachedGoals:"userReachedGoals",withAction:"withAction",actionType:"actionType"},standalone:!0,features:[e.jDz],decls:3,vars:2,consts:[["class","goal-list",4,"ngIf","ngIfElse"],["emptylist",""],[1,"goal-list"],[3,"goal","reached","withAction","isMyProposed","upvoted","actionType","upvoteRatio","clickOnGoal",4,"ngFor","ngForOf"],[3,"goal","reached","withAction","isMyProposed","upvoted","actionType","upvoteRatio","clickOnGoal"]],template:function(t,n){if(1&t&&(e.YNc(0,Y,2,2,"div",0),e.YNc(1,B,2,0,"ng-template",null,1,e.W1O)),2&t){const a=e.MAs(2);e.Q6J("ngIf",n.list.length>0)("ngIfElse",a)}},dependencies:[d.ez,d.sg,d.O5,A,Z,L,S,E],styles:[".goal-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;height:80vh;overflow-y:auto;padding:1rem}"],data:{animation:[(0,r.X$)("listAnimation",[(0,r.eR)("* => *",[(0,r.IO)(":enter",[(0,r.oB)({opacity:0}),(0,r.EY)(100,[(0,r.jt)("0.5s",(0,r.oB)({opacity:1}))])],{optional:!0})])])]}}),o})()},1397:(x,v,c)=>{c.d(v,{h:()=>P});var d=c(4140),e=c(3349),f=c(515),r=c(1902),G=c(3071),C=c(3144),y=c(7502);let P=(()=>{class h{constructor(u,g,p,l){this.userService=u,this.http=g,this.toastrService=p,this.apiBase=l,this.createGameURL="",this.insertUserURL="",this.insertProposedGoalURL="",this.upvoteProposedGoalURL="",this.createGameURL=l+d.Z.games.base+d.Z.games.insertGame,this.insertUserURL=l+d.Z.games.base+d.Z.games.insertUser,this.insertProposedGoalURL=l+d.Z.games.base+d.Z.games.insertProposedGoals,this.upvoteProposedGoalURL=l+d.Z.games.base+d.Z.games.upvoteGoal}createGame(u){const p=this.userService.getUserData()?.user?.name;if(console.log(p),!p)return this.toastrService.setToastrType("error"),this.toastrService.setToastrMessage("User is not logged in"),this.toastrService.setSowToastr(!0),f.E;const l={game:{description:u.description,name:u.name},username:p};return console.log({requestBody:l}),this.http.post(this.createGameURL,l).pipe()}addUserToGame(u){const g=this.userService.getUserData()?.user?.name,p=this.userService.getUserData()?.game?.id;return g&&p?this.http.patch(this.insertUserURL,{username:u,adminId:g,gameId:p}):(this.toastrService.setToastrType("error"),this.toastrService.setToastrMessage("Error while inserting the user"),this.toastrService.setSowToastr(!0),f.E)}addProposedGoalToGame(u){if(!u)return;const g=this.userService.getUserData()?.game?.id,p=this.userService.getUserData()?.user.name;return g&&p?this.http.patch(this.insertProposedGoalURL,{gameId:g,goals:[u],username:p}):void 0}upvoteProposedGoal(u){const g=this.userService.getUserData()?.game?.id,p=this.userService.getUserData()?.user.name;if(g&&p)return this.http.patch(this.upvoteProposedGoalURL,{gameId:g,goalId:u,username:p})}}return h.\u0275fac=function(u){return new(u||h)(r.LFG(G.K),r.LFG(C.eN),r.LFG(y._),r.LFG(e.Sg))},h.\u0275prov=r.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()}}]);