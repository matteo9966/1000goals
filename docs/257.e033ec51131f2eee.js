"use strict";(self.webpackChunk_1000goals_frontend=self.webpackChunk_1000goals_frontend||[]).push([[257],{7257:(O,c,t)=>{t.r(c),t.d(c,{ChangePasswordComponent:()=>C});var _=t(4755),u=t(2980),d=t(5855),n=t(5030),p=t(7124),m=t(1354),l=t(2835),h=t(1135),f=t(8386),s=t(1902),P=t(3071),g=t(7502),v=t(774);const E=function(r){return{"show-text":r}},b=r=>{const i=r.get("password"),e=r.get("confirmPassword");return i?.value!==e?.value?{samePassword:!0}:null};let C=(()=>{class r{constructor(e,o,a,M){this.fb=e,this.userservice=o,this.toastrService=a,this.router=M,this.disableSubmitSubject=new h.X(!0),this.disableSubmit$=this.disableSubmitSubject.asObservable(),this.initForm(),this.form.valueChanges.pipe((0,d.sL)()).subscribe(w=>{this.disableSubmitSubject.next(!(!this.form.invalid&&!this.samePasswordError))})}initForm(){this.form=this.fb.group({password:this.fb.control("",[n.kI.required]),confirmPassword:this.fb.control("",[n.kI.required])},{validators:[b],asyncValidators:[]})}get samePasswordError(){return this.form.errors?.samePassword}onSubmit(){const e=this.form.get("password")?.value,o=this.userservice.getUserData()?.user?.name;if(!o)return this.toastrService.setToastrMessage("missing username, can't change password"),this.toastrService.setToastrType("error"),void this.toastrService.setSowToastr(!0);e&&(this.disableSubmitSubject.next(!0),this.userservice.changePassword(e,o).subscribe(a=>{a&&a?.data?.changed&&(this.toastrService.setToastrMessage("Password updated successfully"),this.toastrService.setToastrType("success"),this.toastrService.setSowToastr(!0),setTimeout(()=>{this.router.navigateByUrl(f.Z.user.base)},1e3))}))}}return r.\u0275fac=function(e){return new(e||r)(s.Y36(n.qu),s.Y36(P.K),s.Y36(g._),s.Y36(v.F0))},r.\u0275cmp=s.Xpm({type:r,selectors:[["app-change-password"]],standalone:!0,features:[s.jDz],decls:11,vars:8,consts:[["title","Change password",3,"formGroup","ngSubmit"],[1,"change-password-container"],["id","password","label","Password","formControlName","password","type","password"],["id","confirm-password","label","Confirm password","formControlName","confirmPassword","type","password"],[1,"error-label",3,"ngClass"],[1,"button-section"],[3,"type","disabled"]],template:function(e,o){1&e&&(s._UZ(0,"app-main-header"),s.TgZ(1,"app-form",0),s.NdJ("ngSubmit",function(){return o.onSubmit()}),s.TgZ(2,"div",1),s._UZ(3,"app-input-text",2)(4,"app-input-text",3),s.TgZ(5,"span",4),s._uU(6,"Input fields don't correspons"),s.qZA(),s.TgZ(7,"section",5)(8,"app-button",6),s.ALo(9,"async"),s._uU(10,"Save"),s.qZA()()()()),2&e&&(s.xp6(1),s.Q6J("formGroup",o.form),s.xp6(4),s.Q6J("ngClass",s.VKq(6,E,o.samePasswordError)),s.xp6(3),s.Q6J("type","submit")("disabled",s.lcZ(9,4,o.disableSubmit$)))},dependencies:[_.ez,_.mk,_.Ov,u.m,n.UX,n.JJ,n.JL,n.sg,n.u,p.U,m.r,l.$],styles:[".change-password-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6rem}.button-section[_ngcontent-%COMP%]{display:flex;justify-content:center}.error-label[_ngcontent-%COMP%]{visibility:hidden}.show-text[_ngcontent-%COMP%]{visibility:visible}"],changeDetection:0}),r})()}}]);