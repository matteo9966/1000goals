"use strict";(self.webpackChunk_1000goals_frontend=self.webpackChunk_1000goals_frontend||[]).push([[501],{4501:(O,d,s)=>{s.r(d),s.d(d,{ProposedGoalsComponent:()=>M});var e=s(1902),m=s(4755),f=s(2980),g=s(7408),h=s(1354),a=s(5030),v=s(1397),u=s(3071),b=s(7502);let C=(()=>{class n{constructor(t,o,r,l){this.fb=t,this.gameService=o,this.userService=r,this.toastrService=l,this.points=50,this.nameMinLength=4,this.initForm()}initForm(){this.form=this.fb.group({name:this.fb.control("",{validators:[a.kI.required,a.kI.minLength(this.nameMinLength)]}),description:this.fb.control("",{validators:[]})})}get nameError(){const o=this.form.get("name")?.errors;if(!o)return null;let r="";const c=Object.keys(o).map(p=>p);return c.includes("minlength")&&(r+=`- min length for name is ${this.nameMinLength}`),c.includes("alphaNumeric")&&(r+="- only alphanumeric characters"),r}get descriptionErrors(){const o=this.form.get("description")?.errors;if(!o)return null;let r="";return Object.keys(o).map(p=>p).includes("alphaNumeric")&&(r+="- only alphanumeric characters"),r}get formValid(){return this.form.valid}onClickAddGoal(){const t=this.form.get("name")?.value,o=this.form.get("description")?.value||"";this.gameService.addProposedGoalToGame({name:t,description:o})?.subscribe(r=>{r?.data?.game&&this.userService.patchUserData(l=>(l.game&&(this.form.reset(),this.form.clearValidators(),Object.entries(this.form.controls).forEach(([c,p])=>{p.setValue(""),p.reset()}),this.toastrService.setToastrMessage("Proposed goal added successfully"),this.toastrService.setSowToastr(!0),l.game.proposedGoals=r?.data?.game?.proposedGoals||[]),l))})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(a.qu),e.Y36(v.h),e.Y36(u.K),e.Y36(b._))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-goal-form"]],standalone:!0,features:[e.jDz],decls:6,vars:4,consts:[["action","",1,"form",3,"formGroup"],["label","Name","formControlName","name",3,"errorLabel"],["label","Description","formControlName","description",3,"errorLabel"],[1,"button-container"],[3,"disabled","click"]],template:function(t,o){1&t&&(e.TgZ(0,"form",0),e._UZ(1,"app-input-text",1)(2,"app-text-area",2),e.TgZ(3,"div",3)(4,"app-button",4),e.NdJ("click",function(){return o.onClickAddGoal()}),e._uU(5,"Create"),e.qZA()()()),2&t&&(e.Q6J("formGroup",o.form),e.xp6(1),e.Q6J("errorLabel",o.nameError),e.xp6(1),e.Q6J("errorLabel",o.descriptionErrors),e.xp6(2),e.Q6J("disabled",!o.formValid))},dependencies:[m.ez,f.m,g.U,h.r,a.UX,a._Y,a.JJ,a.JL,a.sg,a.u],styles:[".form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4rem;padding:6rem 2rem 2rem;background:rgba(255,255,255,0);box-shadow:0 4px 30px #0000001a;backdrop-filter:blur(6.9px);-webkit-backdrop-filter:blur(6.9px);box-shadow:inset 0 0 15px 1px #cacacac7;border:1px solid rgba(202,202,202,.24);border-radius:var(--border-radius)}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:5vw;margin-top:5rem}"]}),n})();var G=s(9836);const T=["proposedgoals"],P=["form"];function x(n,i){}function y(n,i){if(1&n&&e._UZ(0,"app-goal-list",5),2&n){const t=e.oxw();e.Q6J("list",t.proposedGoalList)("withAction",!0)("actionType","upvote")}}function k(n,i){1&n&&e._UZ(0,"app-goal-form")}let M=(()=>{class n{constructor(t){this.userService=t,this._selected="proposed",this.showedTemplate=null}ngOnInit(){this.selected="proposed"}onClickMenu(t){this.selected=t}set selected(t){this._selected=t,"form"!==t?"proposed"===t&&(this.showedTemplate=this.proposedGoalsTemplate):this.showedTemplate=this.formTemplate}get selected(){return this._selected}get proposedGoalList(){return"form"===this.selected?[]:(this.userService.getUserData(),this.userService.getUserData()?.game?.proposedGoals.map(o=>o.goal)||[])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(u.K))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-proposed-goals"]],viewQuery:function(t,o){if(1&t&&(e.Gf(T,7,e.Rgc),e.Gf(P,7,e.Rgc)),2&t){let r;e.iGM(r=e.CRH())&&(o.proposedGoalsTemplate=r.first),e.iGM(r=e.CRH())&&(o.formTemplate=r.first)}},standalone:!0,features:[e.jDz],decls:10,vars:5,consts:[[1,"menu-buttons"],[1,"button",3,"click"],[3,"ngTemplateOutlet"],["proposedgoals",""],["form",""],[3,"list","withAction","actionType"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"button",1),e.NdJ("click",function(){return o.onClickMenu("proposed")}),e._uU(2,"Proposed goals"),e.qZA(),e.TgZ(3,"button",1),e.NdJ("click",function(){return o.onClickMenu("form")}),e._uU(4,"Propose"),e.qZA()(),e.YNc(5,x,0,0,"ng-template",2),e.YNc(6,y,1,3,"ng-template",null,3,e.W1O),e.YNc(8,k,1,0,"ng-template",null,4,e.W1O)),2&t&&(e.xp6(1),e.ekj("active","proposed"==o.selected),e.xp6(2),e.ekj("active","form"==o.selected),e.xp6(2),e.Q6J("ngTemplateOutlet",o.showedTemplate))},dependencies:[m.ez,m.tP,C,G.e],styles:[".goal-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;padding:.6rem;height:90vh;overflow-y:auto}.snap-container[_ngcontent-%COMP%]{height:100vh}.form-container[_ngcontent-%COMP%]{height:0%}.menu-buttons[_ngcontent-%COMP%]{display:flex;padding:.5rem;gap:1rem;background:var(--user-nav-bg-color);z-index:2;top:var(--user-nav-height);position:sticky}.menu-buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{all:unset;padding:.5rem .7rem;background-color:transparent;outline:1px solid var(--border-primary-color);border-radius:var(--border-radius);font-size:1.5rem}.menu-buttons[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{box-shadow:var(--active-button-box-shadow)}"]}),n})()}}]);